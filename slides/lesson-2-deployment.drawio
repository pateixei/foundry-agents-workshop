<mxfile host="65bd71144e">
  <diagram id="deployment-maf" name="Deployment - MAF Hosted Agent">
    <mxGraphModel dx="1564" dy="936" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1600" pageHeight="900" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="title" parent="1" style="text;html=1;fontSize=20;fontStyle=1;align=center;verticalAlign=middle;whiteSpace=wrap;fillColor=none;strokeColor=none;fontColor=#1A1A2E;labelBackgroundColor=none;" value="Lesson 2 - Processo de Deployment: MAF (Microsoft Agent Framework) Hosted Agent no Foundry" vertex="1">
          <mxGeometry height="40" width="1200" x="200" y="15" as="geometry" />
        </mxCell>
        <!-- Step 1: Write Code -->
        <mxCell id="step1_box" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E3F2FD;strokeColor=#1565C0;arcSize=12;" value="" vertex="1">
          <mxGeometry height="210" width="180" x="40" y="90" as="geometry" />
        </mxCell>
        <mxCell id="step1_num" parent="1" style="ellipse;whiteSpace=wrap;html=1;fillColor=#1565C0;strokeColor=#0D47A1;fontSize=14;fontStyle=1;fontColor=#FFFFFF;" value="1" vertex="1">
          <mxGeometry height="30" width="30" x="50" y="97" as="geometry" />
        </mxCell>
        <mxCell id="step1_title" parent="1" style="text;html=1;fontSize=12;fontStyle=1;align=center;fillColor=none;strokeColor=none;fontColor=#1565C0;labelBackgroundColor=none;" value="Escrever Codigo" vertex="1">
          <mxGeometry height="25" width="180" x="40" y="97" as="geometry" />
        </mxCell>
        <mxCell id="step1_file1" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#1565C0;fontSize=9;fontFamily=Courier New;" value="app.py" vertex="1">
          <mxGeometry height="22" width="140" x="60" y="130" as="geometry" />
        </mxCell>
        <mxCell id="step1_file2" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#1565C0;fontSize=9;fontFamily=Courier New;" value="finance_agent.py" vertex="1">
          <mxGeometry height="22" width="140" x="60" y="155" as="geometry" />
        </mxCell>
        <mxCell id="step1_file3" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#1565C0;fontSize=9;fontFamily=Courier New;" value="tools.py" vertex="1">
          <mxGeometry height="22" width="140" x="60" y="180" as="geometry" />
        </mxCell>
        <mxCell id="step1_file4" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#1565C0;fontSize=9;fontFamily=Courier New;" value="Dockerfile" vertex="1">
          <mxGeometry height="22" width="140" x="60" y="205" as="geometry" />
        </mxCell>
        <mxCell id="step1_desc1" parent="1" style="text;html=1;fontSize=8;align=center;fillColor=none;strokeColor=none;fontColor=#666666;labelBackgroundColor=none;" value="AgentFrameworkAdapter&#xa;FinanceAgent + 3 tools&#xa;Port 8080&#xa;HOSTED_AGENT_VERSION env" vertex="1">
          <mxGeometry height="45" width="140" x="60" y="232" as="geometry" />
        </mxCell>
        <mxCell id="step1_file5" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#1565C0;fontSize=8;fontFamily=Courier New;" value="requirements.txt" vertex="1">
          <mxGeometry height="18" width="140" x="60" y="278" as="geometry" />
        </mxCell>
        <mxCell id="arrow_1_2" edge="1" parent="1" source="step1_box" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#333333;strokeWidth=2;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" target="step2_box">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <!-- Step 2: ACR Build -->
        <mxCell id="step2_box" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E8F5E9;strokeColor=#2E7D32;arcSize=12;" value="" vertex="1">
          <mxGeometry height="210" width="180" x="270" y="90" as="geometry" />
        </mxCell>
        <mxCell id="step2_num" parent="1" style="ellipse;whiteSpace=wrap;html=1;fillColor=#2E7D32;strokeColor=#1B5E20;fontSize=14;fontStyle=1;fontColor=#FFFFFF;" value="2" vertex="1">
          <mxGeometry height="30" width="30" x="280" y="97" as="geometry" />
        </mxCell>
        <mxCell id="step2_title" parent="1" style="text;html=1;fontSize=12;fontStyle=1;align=center;fillColor=none;strokeColor=none;fontColor=#2E7D32;labelBackgroundColor=none;" value="Build no ACR" vertex="1">
          <mxGeometry height="25" width="180" x="270" y="97" as="geometry" />
        </mxCell>
        <mxCell id="step2_cmd" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=none;strokeColor=#000000;fontSize=10;fontFamily=Courier New;fontColor=#000099;align=left;spacingLeft=8;" value="az acr build&#xa;  --registry acr123&#xa;  --image fin-market-agent:v3-noloop&#xa;  --file Dockerfile&#xa;  --no-logs ." vertex="1">
          <mxGeometry height="80" width="156" x="282" y="135" as="geometry" />
        </mxCell>
        <mxCell id="step2_note" parent="1" style="text;html=1;fontSize=8;fontStyle=2;align=center;fillColor=#FFF9C4;strokeColor=#F9A825;rounded=1;fontColor=#666666;labelBackgroundColor=none;" value="--no-logs evita erro&#xa;UnicodeEncodeError&#xa;no Windows (cp1252)" vertex="1">
          <mxGeometry height="40" width="156" x="282" y="225" as="geometry" />
        </mxCell>
        <mxCell id="step2_icon" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#0078D4;strokeColor=#004E8C;fontSize=10;fontStyle=1;fontColor=#FFFFFF;labelBackgroundColor=none;" value="ACR" vertex="1">
          <mxGeometry height="24" width="90" x="315" y="270" as="geometry" />
        </mxCell>
        <mxCell id="arrow_2_3" edge="1" parent="1" source="step2_box" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#333333;strokeWidth=2;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" target="step3_box">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <!-- Step 3: Capability Host -->
        <mxCell id="step3_box" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F3E5F5;strokeColor=#7B1FA2;arcSize=12;" value="" vertex="1">
          <mxGeometry height="210" width="180" x="500" y="90" as="geometry" />
        </mxCell>
        <mxCell id="step3_num" parent="1" style="ellipse;whiteSpace=wrap;html=1;fillColor=#7B1FA2;strokeColor=#4A148C;fontSize=14;fontStyle=1;fontColor=#FFFFFF;" value="3" vertex="1">
          <mxGeometry height="30" width="30" x="510" y="97" as="geometry" />
        </mxCell>
        <mxCell id="step3_title" parent="1" style="text;html=1;fontSize=12;fontStyle=1;align=center;fillColor=none;strokeColor=none;fontColor=#7B1FA2;labelBackgroundColor=none;" value="Capability Host" vertex="1">
          <mxGeometry height="25" width="180" x="500" y="97" as="geometry" />
        </mxCell>
        <mxCell id="step3_desc" parent="1" style="text;html=1;fontSize=9;align=center;fillColor=none;strokeColor=none;fontColor=#666666;labelBackgroundColor=none;" value="Criar Capability Host&#xa;no nivel do Account&#xa;(se nao existir)" vertex="1">
          <mxGeometry height="35" width="160" x="510" y="130" as="geometry" />
        </mxCell>
        <mxCell id="step3_cmd" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=none;strokeColor=#000000;fontSize=10;fontFamily=Courier New;fontColor=#660066;align=left;spacingLeft=6;" value="az resource create&#xa;  --resource-type&#xa;  Microsoft.Cognitive&#xa;  Services/accounts/&#xa;  capabilityHosts&#xa;  --properties&#xa;  enablePublicHosting&#xa;  Environment=true" vertex="1">
          <mxGeometry height="115" width="156" x="512" y="170" as="geometry" />
        </mxCell>
        <mxCell id="arrow_3_4" edge="1" parent="1" source="step3_box" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#333333;strokeWidth=2;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" target="step4_box">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <!-- Step 4: RBAC -->
        <mxCell id="step4_box" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFF3E0;strokeColor=#E65100;arcSize=12;" value="" vertex="1">
          <mxGeometry height="210" width="180" x="730" y="90" as="geometry" />
        </mxCell>
        <mxCell id="step4_num" parent="1" style="ellipse;whiteSpace=wrap;html=1;fillColor=#E65100;strokeColor=#BF360C;fontSize=14;fontStyle=1;fontColor=#FFFFFF;" value="4" vertex="1">
          <mxGeometry height="30" width="30" x="740" y="97" as="geometry" />
        </mxCell>
        <mxCell id="step4_title" parent="1" style="text;html=1;fontSize=12;fontStyle=1;align=center;fillColor=none;strokeColor=none;fontColor=#E65100;labelBackgroundColor=none;" value="Configurar RBAC" vertex="1">
          <mxGeometry height="25" width="180" x="730" y="97" as="geometry" />
        </mxCell>
        <mxCell id="step4_desc" parent="1" style="text;html=1;fontSize=9;align=center;fillColor=none;strokeColor=none;fontColor=#666666;labelBackgroundColor=none;" value="Managed Identity do Projeto&#xa;precisa de 3 roles:" vertex="1">
          <mxGeometry height="25" width="160" x="740" y="130" as="geometry" />
        </mxCell>
        <mxCell id="step4_role1" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FF9800;strokeColor=#E65100;fontSize=10;fontStyle=1;fontColor=#FFFFFF;labelBackgroundColor=none;" value="AcrPull" vertex="1">
          <mxGeometry height="25" width="150" x="750" y="160" as="geometry" />
        </mxCell>
        <mxCell id="step4_role1_scope" parent="1" style="text;html=1;fontSize=8;fontStyle=2;align=center;fillColor=none;strokeColor=none;fontColor=#999;labelBackgroundColor=none;" value="Scope: Azure Container Registry" vertex="1">
          <mxGeometry height="12" width="150" x="750" y="185" as="geometry" />
        </mxCell>
        <mxCell id="step4_role2" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FF9800;strokeColor=#E65100;fontSize=9;fontStyle=1;fontColor=#FFFFFF;labelBackgroundColor=none;" value="Cognitive Services&#xa;OpenAI User" vertex="1">
          <mxGeometry height="30" width="150" x="750" y="202" as="geometry" />
        </mxCell>
        <mxCell id="step4_role2_scope" parent="1" style="text;html=1;fontSize=8;fontStyle=2;align=center;fillColor=none;strokeColor=none;fontColor=#999;labelBackgroundColor=none;" value="Scope: AI Foundry Account" vertex="1">
          <mxGeometry height="12" width="150" x="750" y="232" as="geometry" />
        </mxCell>
        <mxCell id="step4_role3" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FF9800;strokeColor=#E65100;fontSize=10;fontStyle=1;fontColor=#FFFFFF;labelBackgroundColor=none;" value="Azure AI User" vertex="1">
          <mxGeometry height="25" width="150" x="750" y="250" as="geometry" />
        </mxCell>
        <mxCell id="step4_role3_scope" parent="1" style="text;html=1;fontSize=8;fontStyle=2;align=center;fillColor=none;strokeColor=none;fontColor=#999;labelBackgroundColor=none;" value="Scope: AI Foundry Project" vertex="1">
          <mxGeometry height="12" width="150" x="750" y="275" as="geometry" />
        </mxCell>
        <mxCell id="step4_principal" parent="1" style="text;html=1;fontSize=8;fontStyle=2;align=center;fillColor=#FFF9C4;strokeColor=#F9A825;rounded=1;fontColor=#666666;labelBackgroundColor=none;" value="Principal: Project Managed Identity" vertex="1">
          <mxGeometry height="18" width="158" x="745" y="290" as="geometry" />
        </mxCell>
        <!-- Step 5: Register and Start Agent -->
        <mxCell id="step5_box" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FCE4EC;strokeColor=#C62828;arcSize=12;" value="" vertex="1">
          <mxGeometry height="210" width="370" x="220" y="370" as="geometry" />
        </mxCell>
        <mxCell id="step5_num" parent="1" style="ellipse;whiteSpace=wrap;html=1;fillColor=#C62828;strokeColor=#B71C1C;fontSize=14;fontStyle=1;fontColor=#FFFFFF;" value="5" vertex="1">
          <mxGeometry height="30" width="30" x="231" y="377" as="geometry" />
        </mxCell>
        <mxCell id="step5_title" parent="1" style="text;html=1;fontSize=12;fontStyle=1;align=center;fillColor=none;strokeColor=none;fontColor=#C62828;labelBackgroundColor=none;" value="Registrar e Iniciar Agent" vertex="1">
          <mxGeometry height="25" width="300" x="250" y="379.5" as="geometry" />
        </mxCell>
        <mxCell id="step5_cmd1" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=none;strokeColor=#000000;fontSize=9;fontFamily=Courier New;fontColor=#660000;align=left;spacingLeft=8;" value="az cognitiveservices agent create \&#xa;  --account-name ai-foundry001 \&#xa;  --project-name ag365-prj001 \&#xa;  --name fin-market-agent \&#xa;  --agent-version 1 \&#xa;  --container-image acr123.azurecr.io/&#xa;    fin-market-agent:v3-noloop \&#xa;  --no-start" vertex="1">
          <mxGeometry height="105" width="350" x="230" y="400" as="geometry" />
        </mxCell>
        <mxCell id="step5_cmd2" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=none;strokeColor=#000000;fontSize=10;fontFamily=Courier New;fontColor=#006600;align=left;spacingLeft=8;" value="az cognitiveservices agent start \&#xa;  --account-name ai-foundry001 \&#xa;  --project-name ag365-prj001 \&#xa;  --name fin-market-agent \&#xa;  --agent-version 1" vertex="1">
          <mxGeometry height="65" width="350" x="230" y="510" as="geometry" />
        </mxCell>
        <mxCell id="arrow_4_5" edge="1" parent="1" source="step4_box" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#333333;strokeWidth=2;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=1;entryY=0;entryDx=0;entryDy=0;" target="step5_box">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="820" y="340" />
              <mxPoint x="620" y="340" />
              <mxPoint x="620" y="370" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="arrow_4_5_label" parent="1" style="text;html=1;fontSize=8;fontStyle=2;align=center;fillColor=none;strokeColor=none;fontColor=#666666;labelBackgroundColor=none;" value="(prerequisitos prontos)" vertex="1">
          <mxGeometry height="15" width="130" x="630" y="325" as="geometry" />
        </mxCell>
        <!-- Step 6: Verify Status -->
        <mxCell id="step6_box" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E8EAF6;strokeColor=#283593;arcSize=12;" value="" vertex="1">
          <mxGeometry height="210" width="180" x="620" y="370" as="geometry" />
        </mxCell>
        <mxCell id="step6_num" parent="1" style="ellipse;whiteSpace=wrap;html=1;fillColor=#283593;strokeColor=#1A237E;fontSize=14;fontStyle=1;fontColor=#FFFFFF;" value="6" vertex="1">
          <mxGeometry height="30" width="30" x="630" y="377" as="geometry" />
        </mxCell>
        <mxCell id="step6_title" parent="1" style="text;html=1;fontSize=12;fontStyle=1;align=center;fillColor=none;strokeColor=none;fontColor=#283593;labelBackgroundColor=none;" value="Verificar Status" vertex="1">
          <mxGeometry height="25" width="180" x="620" y="377" as="geometry" />
        </mxCell>
        <mxCell id="step6_cmd" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=none;strokeColor=#000000;fontSize=10;fontFamily=Courier New;fontColor=#003366;align=left;spacingLeft=8;" value="az cognitiveservices&#xa;  agent show \&#xa;  --name fin-market-agent \&#xa;  --agent-version 1" vertex="1">
          <mxGeometry height="60" width="156" x="632" y="410" as="geometry" />
        </mxCell>
        <mxCell id="step6_status" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#C8E6C9;strokeColor=#2E7D32;fontSize=9;align=center;fontStyle=1;fontColor=#2E7D32;labelBackgroundColor=none;" value="provisioningState:&#xa;&quot;Succeeded&quot;&#xa;&#xa;containerState:&#xa;&quot;Running&quot;" vertex="1">
          <mxGeometry height="70" width="140" x="640" y="475" as="geometry" />
        </mxCell>
        <mxCell id="arrow_5_6" edge="1" parent="1" source="step5_box" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#333333;strokeWidth=2;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" target="step6_box">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <!-- Step 7: Test -->
        <mxCell id="step7_box" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E0F7FA;strokeColor=#00695C;arcSize=12;" value="" vertex="1">
          <mxGeometry height="240" width="280" x="850" y="370" as="geometry" />
        </mxCell>
        <mxCell id="step7_num" parent="1" style="ellipse;whiteSpace=wrap;html=1;fillColor=#00695C;strokeColor=#004D40;fontSize=14;fontStyle=1;fontColor=#FFFFFF;" value="7" vertex="1">
          <mxGeometry height="30" width="30" x="860" y="377" as="geometry" />
        </mxCell>
        <mxCell id="step7_title" parent="1" style="text;html=1;fontSize=12;fontStyle=1;align=center;fillColor=none;strokeColor=none;fontColor=#00695C;labelBackgroundColor=none;" value="Testar via Responses API" vertex="1">
          <mxGeometry height="25" width="280" x="850" y="377" as="geometry" />
        </mxCell>
        <mxCell id="step7_cmd" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=none;strokeColor=#000000;fontSize=9;fontFamily=Courier New;fontColor=#006633;align=left;spacingLeft=8;arcSize=6;" value="POST https://ai-foundry001&#xa;  .services.ai.azure.com/api/&#xa;  projects/ag365-prj001/&#xa;  openai/responses&#xa;  ?api-version=2025-11-15-preview&#xa;&#xa;Body:&#xa;{&#xa;  &quot;input&quot;: [{&quot;role&quot;:&quot;user&quot;,&#xa;    &quot;content&quot;:&quot;...&quot;}],&#xa;  &quot;agent&quot;: {&#xa;    &quot;id&quot;: &quot;{agent-id}&quot;,&#xa;    &quot;name&quot;: &quot;fin-market-agent&quot;,&#xa;    &quot;version&quot;: &quot;1&quot;,&#xa;    &quot;type&quot;: &quot;agent_reference&quot;&#xa;  }&#xa;}" vertex="1">
          <mxGeometry height="190" width="256" x="862" y="410" as="geometry" />
        </mxCell>
        <mxCell id="arrow_6_7" edge="1" parent="1" source="step6_box" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#333333;strokeWidth=2;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" target="step7_box">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <!-- Success -->
        <mxCell id="success" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#4CAF50;strokeColor=#2E7D32;fontSize=16;fontStyle=1;fontColor=#FFFFFF;shadow=1;labelBackgroundColor=none;" value="Agent Deployed!" vertex="1">
          <mxGeometry height="50" width="200" x="1170" y="445" as="geometry" />
        </mxCell>
        <mxCell id="arrow_7_done" edge="1" parent="1" source="step7_box" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#4CAF50;strokeWidth=3;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" target="success">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <!-- Summary -->
        <mxCell id="summary_box" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F5F5F5;strokeColor=#9E9E9E;dashed=1;" value="" vertex="1">
          <mxGeometry height="55" width="1330" x="40" y="620" as="geometry" />
        </mxCell>
        <mxCell id="summary_title" parent="1" style="text;html=1;fontSize=10;fontStyle=1;align=left;fillColor=none;strokeColor=none;labelBackgroundColor=none;" value="Resumo do Fluxo:" vertex="1">
          <mxGeometry height="20" width="100" x="50" y="625" as="geometry" />
        </mxCell>
        <mxCell id="summary" parent="1" style="text;html=1;fontSize=9;align=left;fillColor=none;strokeColor=none;fontColor=#555555;spacingLeft=5;labelBackgroundColor=none;" value="Codigo (app.py + finance_agent.py + tools.py + Dockerfile) -&gt; ACR Build (az acr build --no-logs) -&gt; Capability Host -&gt; RBAC (AcrPull + OpenAI User + AI User) -&gt; Registrar Agent (az cognitiveservices agent create --no-start) -&gt; Iniciar (start) -&gt; Verificar (show) -&gt; Testar (POST /openai/responses)" vertex="1">
          <mxGeometry height="25" width="1300" x="50" y="645" as="geometry" />
        </mxCell>
        <!-- Workarounds -->
        <mxCell id="workaround_box" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFF9C4;strokeColor=#F9A825;dashed=1;" value="" vertex="1">
          <mxGeometry height="95" width="1330" x="40" y="690" as="geometry" />
        </mxCell>
        <mxCell id="workaround_title" parent="1" style="text;html=1;fontSize=10;fontStyle=1;align=left;fillColor=none;strokeColor=none;fontColor=#F57F17;labelBackgroundColor=none;" value="(!) Workarounds Importantes (Preview - MAF Hosted Agent):" vertex="1">
          <mxGeometry height="20" width="350" x="50" y="695" as="geometry" />
        </mxCell>
        <mxCell id="workaround_list" parent="1" style="text;html=1;fontSize=8;align=left;fillColor=none;strokeColor=none;fontColor=#666666;spacingLeft=5;labelBackgroundColor=none;" value="1. --no-logs no az acr build (Windows cp1252 encoding)    2. HOSTED_AGENT_VERSION env var no Dockerfile (requerido pelo adapter)    3. Monkey-patch _get_agent_reference_or_create (ID nao populado automaticamente)&#xa;4. Monkey-patch _prepare_options (prevenir routing recursivo do adapter)    5. Monkey-patch AgentReference.id strip (campo com caracteres extras)    6. Body do REST precisa campo &quot;id&quot; em agent (SDK nao inclui automaticamente)&#xa;7. RBAC: Azure AI User necessario ALEM de Cognitive Services OpenAI User (nao documentado)" vertex="1">
          <mxGeometry height="55" width="1300" x="50" y="718" as="geometry" />
        </mxCell>
        <!-- Comparison note -->
        <mxCell id="compare_box" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E3F2FD;strokeColor=#1565C0;dashed=1;" value="" vertex="1">
          <mxGeometry height="45" width="1330" x="40" y="800" as="geometry" />
        </mxCell>
        <mxCell id="compare_text" parent="1" style="text;html=1;fontSize=9;align=left;fillColor=none;strokeColor=none;fontColor=#1565C0;spacingLeft=5;fontStyle=1;labelBackgroundColor=none;" value="Diferenca vs LangGraph (Lesson 3): MAF usa AgentFrameworkAdapter (agentserver-agentframework) com protocol versioning. Tem 3 RBAC roles (vs 2). Necessita HOSTED_AGENT_VERSION env var. Mais monkey-patches necessarios (3 vs 2)." vertex="1">
          <mxGeometry height="30" width="1300" x="50" y="808" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
